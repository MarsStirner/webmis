<?php
header("Content-Type:application/json; charset=utf-8");

$callback_name = "callback";

if ( !empty($_GET["callback"]) ) {
	$callback_name = $_GET["callback"];
}

$list = '{"id":1,"name":"Cправочник социальных статусов","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":2,"name":"Справочник групп крови","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":3,"name":"Справочник типов жителей","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":4,"name":"Справочник типов инвалидности","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":5,"name":"Справочник документов, подтверждающих инвалидность","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":6,"name":"Справочник Род войск (военнослужащий)","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":7,"name":"Справочник званий (военнослужащий)","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":8,"name":"Cправочник участков","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":9,"name":"Справочник степени аллергии","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":10,"name":"Справочник категорий федеральных льготников","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":11,"name":"Справочник категорий региональных льгот","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":12,"name":"Справочник 7 нозологий","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":13,"name":"Справочник аллергий","description":"string","fieldDescriptionList":[],"recordList":[]},{"id":14,"name":"Справочник мест работы","description":"string","fieldDescriptionList":[],"recordList":[]}';

$social = '{"id":1,"name":"Cправочник социальных статусов","description":"string","fieldDescriptionList":[],"recordList":[{"id":1,"order":1,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":1,"value":"0"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":2,"value":"Неработающий"}}]},{"id":2,"order":2,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":3,"value":"1"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":4,"value":"Работающий"}}]},{"id":3,"order":3,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":5,"value":"2"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":6,"value":"Неработающий пенсионер"}}]},{"id":4,"order":4,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":7,"value":"3"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":8,"value":"Дошкольник"}}]},{"id":5,"order":5,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":9,"value":"4"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":10,"value":"Учащийся"}}]},{"id":6,"order":6,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":11,"value":"5"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":12,"value":"Военнослужащий"}}]},{"id":7,"order":7,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":13,"value":"6"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":14,"value":"Член семьи военнослужащего"}}]},{"id":8,"order":8,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":15,"value":"7"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":16,"value":"БОМЖ"}}]}]}';
$disabledType = '{"id":4,"name":"Справочник типов инвалидности","description":"string","fieldDescriptionList":[],"recordList":[{"id":19,"order":1,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":47,"value":"1"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":48,"value":"0"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":49,"value":"Инвалидность снята"}}]},{"id":20,"order":2,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":50,"value":"2"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":51,"value":"1"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":52,"value":"1 группа"}}]},{"id":21,"order":3,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":53,"value":"3"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":54,"value":"2"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":55,"value":"2 группа"}}]},{"id":22,"order":4,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":56,"value":"4"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":57,"value":"3"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":58,"value":"3 группа"}}]},{"id":23,"order":5,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":59,"value":"5"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":60,"value":"4"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":61,"value":"Инвалид детства"}}]}]}';
$benefitCategories = '{"id":10,"name":"Справочник категорий федеральных льготников","description":"string","fieldDescriptionList":[],"recordList":[{"id":82,"order":1,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":284,"value":"1"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":285,"value":"1"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":286,"value":"Инвалид войны"}}]},{"id":83,"order":2,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":287,"value":"2"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":288,"value":"2"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":289,"value":"Участники ВОВ"}}]},{"id":84,"order":3,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":290,"value":"3"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":291,"value":"3"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":292,"value":"Ветераны боевых действий"}}]},{"id":85,"order":4,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":293,"value":"4"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":294,"value":"4"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":295,"value":"Военнослужащие, проходившие военную службу..."}}]},{"id":86,"order":5,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":296,"value":"5"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":297,"value":"5"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":298,"value":"Граждане, награжденные знаком \"Жителю блокадного Ленинграда\""}}]},{"id":87,"order":6,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":299,"value":"6"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":300,"value":"6"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":301,"value":"Лица, работавшие в период ВОВ"}}]},{"id":88,"order":7,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":302,"value":"7"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":303,"value":"7"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":304,"value":"Члены семей погибших (умерших) инвалидов войны"}}]},{"id":89,"order":8,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":305,"value":"8"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":306,"value":"8"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":307,"value":"Инвалид III группы"}}]},{"id":90,"order":9,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":308,"value":"9"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":309,"value":"9"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":310,"value":"Инвалид II группы"}}]},{"id":91,"order":10,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":311,"value":"10"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":312,"value":"10"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":313,"value":"Инвалид I группы"}}]},{"id":92,"order":11,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":314,"value":"11"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":315,"value":"11"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":316,"value":"Дети-инвалиды"}}]},{"id":93,"order":12,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":317,"value":"12"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":318,"value":"12"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":319,"value":"Граждане, пострадавшие в результате радиационных техногенных катасроф"}}]},{"id":94,"order":13,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":320,"value":"13"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":321,"value":"13"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":322,"value":"Граждане РФ, удостоенные званий Героя Советского Союза, Героя РФ или являющиеся полными кавалерами"}}]},{"id":95,"order":14,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":323,"value":"14"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":324,"value":"14"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":325,"value":"Члены семей (вдова, вдовец), родители дети до 18 лет, дети старше 18 лет, ставшие инвалидами до достижения ими 18 лет"}}]},{"id":96,"order":15,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":326,"value":"15"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":327,"value":"15"}},{"fieldDescription":{"id":3,"order":0},"fieldValue":{"id":328,"value":"Граждане РФ, удостоенные звания Героя Социалистического труда либо награжденные"}}]}]}';
$forceBranches = '{"id":6,"name":"Cправочник социальных статусов","description":"string","fieldDescriptionList":[],"recordList":[{"id":1,"order":1,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":1,"value":"0"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":2,"value":"Неработающий"}}]},{"id":2,"order":2,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":3,"value":"1"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":4,"value":"Работающий"}}]},{"id":3,"order":3,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":5,"value":"2"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":6,"value":"Неработающий пенсионер"}}]},{"id":4,"order":4,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":7,"value":"3"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":8,"value":"Дошкольник"}}]},{"id":5,"order":5,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":9,"value":"4"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":10,"value":"Учащийся"}}]},{"id":6,"order":6,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":11,"value":"5"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":12,"value":"Военнослужащий"}}]},{"id":7,"order":7,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":13,"value":"6"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":14,"value":"Член семьи военнослужащего"}}]},{"id":8,"order":8,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":15,"value":"7"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":16,"value":"БОМЖ"}}]}]}';
$ranks = '{"id":7,"name":"Cправочник социальных статусов","description":"string","fieldDescriptionList":[],"recordList":[{"id":1,"order":1,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":1,"value":"0"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":2,"value":"Неработающий"}}]},{"id":2,"order":2,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":3,"value":"1"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":4,"value":"Работающий"}}]},{"id":3,"order":3,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":5,"value":"2"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":6,"value":"Неработающий пенсионер"}}]},{"id":4,"order":4,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":7,"value":"3"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":8,"value":"Дошкольник"}}]},{"id":5,"order":5,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":9,"value":"4"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":10,"value":"Учащийся"}}]},{"id":6,"order":6,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":11,"value":"5"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":12,"value":"Военнослужащий"}}]},{"id":7,"order":7,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":13,"value":"6"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":14,"value":"Член семьи военнослужащего"}}]},{"id":8,"order":8,"fieldValueList":[{"fieldDescription":{"id":1,"order":0},"fieldValue":{"id":15,"value":"7"}},{"fieldDescription":{"id":2,"order":0},"fieldValue":{"id":16,"value":"БОМЖ"}}]}]}';

$fds = array(
	"1" => $social,
	"4" => $disabledType,
	"10" => $benefitCategories,
	"6" => $forceBranches,
	"7" => $ranks
	);

$query  = explode('&', $_SERVER['QUERY_STRING']);
$params = array();

foreach( $query as $param ) {
  list($name, $value) = explode('=', $param);
  $params[urldecode($name)][] = urldecode($value);
}

$data = '"data":';

if (isset($params["flatDirectoryId"]) && !empty($params["flatDirectoryId"])) {
	$data .= "[";
	
	for ($i = 0; $i < sizeof($params["flatDirectoryId"]); $i++) {
		if (isset($params["flatDirectoryId"][$i])) {
			$data .= $fds[$params["flatDirectoryId"][$i]];

			if ($i < sizeof($params["flatDirectoryId"]) - 1) {
				$data .= ",";
			}
		}
	}

	$data .= "]";
} else {
	$data .= "[".$list."]";
}

//var_dump($params);
echo $callback_name
	.'({"requestData":{"filter":{"flatDictionaryIds":[],"includeMeta":false,"includeRecordList":true,"includeFDRecord":false,"filterFields":{},"filterValues":null,"filterRecordIds":null},"sortingFields":null,"sortingMethod":"asc","limit":10,"page":1,"recordsCount":0,"coreVersion":"1.0.0.6"},'
	.$data
	.'});';
?>
